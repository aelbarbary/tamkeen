{% load static %}

<link href="{% static "/css/attendance.css" %}" rel="stylesheet">
<link href ="//cdn.datatables.net/1.10.16/css/jquery.dataTables.min.css" rel="stylesheet">
<script src="{% static "vendor/jquery/jquery.min.js" %}"></script>
<script data-cfasync="false" type="text/javascript" src="//cdn.datatables.net/1.10.16/js/jquery.dataTables.min.js"></script>
<!-- Bootstrap Core CSS -->
<link href="{% static "/vendor/bootstrap/css/bootstrap.min.css" %}" rel="stylesheet">
<link href="{% static "css/freelancer.css" %}"  rel="stylesheet">

<style>
  tr > th:nth-of-type(9),
  tr > td:nth-of-type(9) {
  display: none;
  }

  td{
    font-size: 15pt;
  }
</style>

<script>
$(document).ready(function() {
  var t = $('#example').DataTable({
    paging: false,
    "ajax":{
      "url":  "/rest/members/attendance/",
    },
  });

  $.ajax({
             type: "GET",
             dataType: "json",
             url: "/rest/members/attendance/",
             success: function(data){
               data.forEach(function(entry) {
                 uw_waiver = entry["uw_waiver"]
                 photo = entry["photo"]
                 attended_today = entry["attended_today"]
                 checkbox = "<input id='checkbox" + entry["id"] + "'  type='checkbox' onclick='saveAttendance(" + entry["id"] + ");'"
                 if (attended_today == true)
                 {
                    checkbox += "checked";
                 }
                 checkbox += "></input>"
                 row = t.row.add( [
                     checkbox,
                     entry["first_name"],
                     entry["last_name"],
                     entry["gender"],
                     entry["age"],
                 ] ).draw( false );
             }
         )}
       });
} );

function saveAttendance(user_id)
{
  checked = false
  if ($("#checkbox" + user_id).is(':checked'))
    checked = true
  data = { userId: user_id, checked: checked }
  $.ajax({
      type: "POST",
      url: "/rest/members/attendance/new",
      data: JSON.stringify(data),
      success: function(result) {

      },
      error: function(xhr, status, error) {
        alert(error);
      }
  });
}

</script>

<body id="page-top" class="index">

    <!-- Navigation -->
    <nav class="navbar navbar-default  navbar-custom">
        <div class="container">
            <!-- Brand and toggle get grouped for better mobile display -->
            <div class="navbar-header page-scroll">
                <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                    <span class="sr-only">Toggle navigation</span> Menu <i class="fa fa-bars"></i>
                </button>
                <a class="navbar-brand" href="#page-top">Attendacne Sheet</a>
            </div>

            <!-- Collect the nav links, forms, and other content for toggling -->
            <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
                <ul class="nav navbar-nav navbar-right">
                    <li class="hidden">
                        <a href="#page-top"></a>
                    </li>

                    <li class="page-scroll">
                        <a href="/">Home</a>
                    </li>
                 </ul>
            </div>
            <!-- /.navbar-collapse -->
        </div>
        <!-- /.container-fluid -->
    </nav>
    <div class="center text-center alert alert-info">
      <h4 id="datetime" style="al"></h4>
    </div>
  <table id="example" class="display" cellspacing="0" width="100%">

          <thead>
              <tr>
                  <th></th>
                  <th>First Name</th>
                  <th>Last Name</th>
                  <th>Gender</th>
              </tr>
          </thead>

          <tfoot>
              <tr>
                <th></th>
                <th>First Name</th>
                <th>Last Name</th>
                <th>Gender</th>
              </tr>
          </tfoot>
      </table>

  </body>

  <script>
    document.getElementById("datetime").innerHTML =  new Date().toJSON().slice(0,10).replace(/-/g,'/');
  </script>
