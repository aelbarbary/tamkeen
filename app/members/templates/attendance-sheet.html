{% load static %}

<link href="{% static "/css/attendance.css" %}" rel="stylesheet">
<link href ="//cdn.datatables.net/1.10.16/css/jquery.dataTables.min.css" rel="stylesheet">
<script src="{% static "vendor/jquery/jquery.min.js" %}"></script>
<script data-cfasync="false" type="text/javascript" src="//cdn.datatables.net/1.10.16/js/jquery.dataTables.min.js"></script>

<style>
  tr > th:nth-of-type(9),
  tr > td:nth-of-type(9) {
  display: none;
  }

  td{
    font-size: 15pt;
  }
</style>

<script>

$(document).ready(function() {
  var t = $('#example').DataTable({
    paging: false,
  });

  $.ajax({
             type: "GET",
             dataType: "json",
             url: "/rest/members/attendance/",
             success: function(data){
               data.forEach(function(entry) {
                 uw_waiver = entry["uw_waiver"]
                 photo = entry["photo"]
                 attended_today = entry["attended_today"]
                 checkbox = "<input id='checkbox" + entry["id"] + "'  type='checkbox' onclick='saveAttendance(" + entry["id"] + ");'"
                 if (attended_today == true)
                 {
                    checkbox += "checked";
                 }
                 checkbox += "></input>"

                 row = t.row.add( [
                     checkbox,
                     entry["first_name"],
                     entry["last_name"],
                     entry["gender"],
                     entry["age"],
                 ] ).draw( false );
             }
         )}
       });
} );

function saveAttendance(user_id)
{
  checked = false
  if ($("#checkbox" + user_id).is(':checked'))
    checked = true
  data = { userId: user_id, checked: checked }
  $.ajax({
      type: "POST",
      url: "/rest/members/attendance/new",
      data: JSON.stringify(data),
      success: function(result) {

      },
      error: function(xhr, status, error) {
        alert(error);
      }
  });
}

</script>


<table id="example" class="display" cellspacing="0" width="100%">
        <thead>
            <tr>
                <th></th>
                <th>First Name</th>
                <th>Last Name</th>
                <th>Gender</th>
                <th>Age</th>
            </tr>
        </thead>
        <tfoot>
            <tr>
              <th></th>
              <th>First Name</th>
              <th>Last Name</th>
              <th>Gender</th>
              <th>Age</th>
            </tr>
        </tfoot>
    </table>
